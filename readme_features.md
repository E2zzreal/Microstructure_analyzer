# Microstructure Analyzer Feature Documentation

This document details the features extracted by the `microstructure_analyzer` package. Features are categorized into Per-Region, Aggregate Statistics, and Global Features.

## 1. Per-Region Features

These features are calculated individually for each segmented region (grain, thin wall, or junction) identified in the microstructure image. The prefix (`grain_`, `thinw_`, `junc_`) indicates the region type in the output data, but the base feature calculation is the same.

| Feature Name                 | Calculation Method                                                                                                                               | Potential Materials Science Significance                                                                                                                                                              |
| :--------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `label`                      | Unique integer identifier assigned to each region during labeling.                                                                               | Identification of individual microstructural constituents.                                                                                                                                            |
| `centroid_y`, `centroid_x`   | Coordinates of the region's geometric center (center of mass).                                                                                   | Locates the position of each grain/feature, essential for spatial distribution analysis (e.g., distances, network graphs).                                                                          |
| `area`                       | Counts the number of pixels within the region.                                                                                                   | Direct measure of grain/phase size, strongly influencing mechanical properties (Hall-Petch), phase stability, and kinetics (grain growth, diffusion).                                            |
| `equivalent_diameter`        | Diameter of a circle with the same area as the region. `sqrt(4 * Area / pi)`.                                                                    | Provides a standardized measure of region size, useful for comparisons regardless of shape.                                                                                                           |
| `feret_diameter_max`         | Maximum distance between any two parallel tangents touching the boundary of the region.                                                          | Represents the maximum caliper dimension of the region, indicating its largest extent.                                                                                                                |
| `perimeter`                  | Approximate length of the region's boundary.                                                                                                     | Relates to the amount of interface area. Higher perimeter-to-area ratios often indicate more complex shapes or smaller sizes, influencing boundary energy and mobility.                             |
| `aspect_ratio`               | Ratio of the major axis length to the minor axis length of the ellipse with the same normalized second central moments as the region.              | Indicates shape anisotropy. Elongated grains can lead to anisotropic mechanical properties, texture development, and influence fracture paths.                                                    |
| `compactness`                | `(4 * pi * Area) / Perimeter^2`. Measures how closely the shape resembles a circle (value is 1 for a perfect circle). Also known as circularity. | Quantifies shape regularity. Deviations from 1 indicate irregularity, potentially due to impingement during growth, specific crystallographic habits, or deformation.                               |
| `elongation`                 | `1 - (minor_axis_length / major_axis_length)`. Measures how elongated the shape is.                                                              | Similar to aspect ratio, quantifies the degree of elongation. High elongation suggests directional growth or deformation.                                                                       |
| `rectangularity`             | `Area / Area_of_Bounding_Box`. Measures how well the region fills its minimum bounding box.                                                      | Indicates how "boxy" or rectangular a shape is. Can relate to specific crystal symmetries or packing arrangements.                                                                                  |
| `convexity`                  | `Area / Area_of_Convex_Hull`. Measures how close the region is to being convex (value is 1 for a convex shape).                                   | Quantifies the degree of concavity or surface roughness. Low convexity suggests indentations or irregular boundaries, potentially related to etching, corrosion, or complex growth interfaces. |
| `orientation`                | Angle (radians) of the major axis relative to the horizontal axis, calculated via Principal Component Analysis (PCA) of the region's coordinates. | Represents the primary orientation of the grain/feature. Collective alignment indicates crystallographic texture, leading to anisotropic material properties.                                       |
| `hu_moments_0` to `_6`       | Set of 7 moments invariant to translation, scale, and rotation, calculated from image moments.                                                   | Provides a quantitative shape signature robust to geometric transformations. Can be used for shape classification or comparison.                                                                  |
| `fractal_dimension_boxcount` | Calculated using a box-counting algorithm on the region's binary image. Estimates `log(N) / log(1/s)`, where N is the box count at scale s.       | Measures the complexity and space-filling capacity of the region's boundary or internal structure. Higher values indicate more intricate or rough shapes.                                        |
| `skeleton_branches`          | Counts pixels in the region's morphological skeleton with >= 3 neighboring skeleton pixels.                                                      | Reflects internal complexity or branching (e.g., dendritic structures, internal porosity).                                                                                                            |
| `skeleton_length_ratio`      | Length of the morphological skeleton divided by the region's area.                                                                               | Normalizes skeleton length by size, potentially indicating the "density" of the internal structure.                                                                                                   |
| `slenderness`                | `Perimeter / (2 * sqrt(pi * Area))`. Related to the inverse square root of compactness.                                                          | Another measure of shape irregularity or deviation from circularity. Higher values indicate more slender or complex shapes.                                                                       |
| `num_neighbors`              | Count of adjacent regions touching the current region (based on `TopologyAnalyzer`).                                                             | Physical coordination number. High neighbor count suggests a densely packed environment, influencing local stress concentration and grain boundary sliding/migration.                              |
| `neighbor_area_mean`         | Mean area of the physically adjacent neighboring regions.                                                                                        | Characterizes the average size of the immediate neighbors. Can indicate local size homogeneity or heterogeneity.                                                                                    |
| `neighbor_area_std`          | Standard deviation of the areas of physically adjacent neighboring regions.                                                                      | Measures the variation in size among immediate neighbors. High variation might indicate abnormal grain growth or mixed microstructures.                                                         |
| `neighbor_size_variation`    | `neighbor_area_std / neighbor_area_mean`. Coefficient of variation for neighbor areas.                                                           | Normalized measure of size variation among neighbors, independent of the absolute average size.                                                                                                       |
| `delaunay_degree_*`          | Degree (number of connections) of the node representing the region's centroid in a Delaunay graph built with a specific distance threshold (`*`). | Represents spatial coordination number based on proximity (not just physical contact). Different thresholds probe connectivity at different length scales. Influences percolation, transport, network stability. |

*Note: `delaunay_degree_*` features are generated for multiple fixed thresholds (e.g., `_fixed_50`) and adaptive thresholds (e.g., `_adaptive_2r1_0std`).*

## 2. Aggregate Statistics

These features represent the statistical distribution (mean and standard deviation) of the Per-Region features calculated across all regions of the *same type* within the image. They are prefixed with the region type (`grain_`, `thinw_`, `junc_`) followed by the base feature name and the statistic (`_mean` or `_std`).

| Feature Name Pattern                 | Calculation Method                                                                 | Potential Materials Science Significance                                                                                                                                                                                             |
| :----------------------------------- | :--------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `[type]_[feature]_mean`              | Mean value of the specified `[feature]` (e.g., `area`, `compactness`) across all regions of `[type]` (e.g., `grain`, `thinw`, `junc`). | Provides the average characteristic for a specific feature across all grains, thin walls, or junctions. E.g., `grain_area_mean` is the average grain size.                                                              |
| `[type]_[feature]_std`               | Standard deviation of the specified `[feature]` across all regions of `[type]`.    | Quantifies the variability or spread of the `[feature]` within the population of grains, thin walls, or junctions. E.g., `grain_area_std` indicates the dispersion of grain sizes around the mean, reflecting microstructural homogeneity. |

*Example: `grain_area_mean`, `grain_area_std`, `thinw_compactness_mean`, `junc_skeleton_branches_std`, etc.*

## 3. Global Features

These features describe the overall characteristics of the microstructure, typically calculated based on the properties and arrangement of all grains. They are prefixed with `global_`.

| Feature Name                     | Calculation Method                                                                                                                               | Potential Materials Science Significance                                                                                                                                                              |
| :------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `num_grains`                     | Total count of unique grain regions identified.                                                                                                  | Inverse measure of average grain size or grain density. Directly impacts properties governed by grain boundary area (strength, conductivity, corrosion).                                            |
| `area_mean`, `area_std`          | Mean and standard deviation of the area for all grain regions. (Redundant with `grain_area_mean/std` but often included for convenience).        | Overall average grain size and its variation across the entire sample area analyzed.                                                                                                                  |
| `total_boundary_length`          | Sum of the lengths of all boundaries detected between adjacent grain regions.                                                                    | Total grain boundary area per unit volume (or area in 2D). Higher values correlate with finer grain sizes and influence properties like strength and boundary diffusion.                               |
| `mean_boundary_curvature`        | Average curvature calculated along all inter-grain boundaries.                                                                                   | Reflects the overall energy state and stability of the grain boundary network. Higher average curvature suggests a less equilibrated structure, potentially driving grain growth.                     |
| `nn_dist_mean`, `nn_dist_std`    | Mean and standard deviation of the Euclidean distance from each grain centroid to its nearest neighboring grain centroid.                          | Characterizes the average spacing and regularity of the grain arrangement. Influences inter-grain interactions, dislocation movement, crack propagation, and diffusion distances.                   |
| `pairwise_dist_mean`, `pairwise_dist_std` | Mean and standard deviation of the Euclidean distances between all pairs of grain centroids.                                             | Provides a broader measure of spatial distribution than nearest neighbors, reflecting the overall dispersion or clustering of grains across the analyzed area.                                       |
| `orientation_mean`, `orientation_std` | Mean and standard deviation of the `orientation` feature (calculated via PCA) for all grains.                                                | Quantifies the average grain orientation and the degree of alignment (texture). Strong texture leads to anisotropic material properties.                                                            |
| `boundary_fractal_dim`           | Fractal dimension calculated using box-counting specifically on the binary image of the grain boundaries.                                        | Measures the complexity or tortuosity of the overall grain boundary network. Higher values indicate more convoluted boundary paths, affecting transport properties and fracture toughness.           |
| `persistence_H0_mean`            | Mean lifespan (death time - birth time) of 0-dimensional topological features (connected components) in the Rips complex built on grain centroids. | Quantifies the stability of clusters or connected components as the proximity threshold increases in the Rips filtration. Relates to the scale and persistence of grain clustering.                |
| `persistence_H1_mean`            | Mean lifespan of 1-dimensional topological features (loops/holes) in the Rips complex.                                                           | Quantifies the presence and stability of "voids" or cycles in the spatial arrangement of grains. Could relate to porosity distribution, network connectivity gaps, or the scale of clustering.        |
| `degree_dist_[0-8]_*`            | Count of nodes (grains) having a specific degree (0 to 8) in the Delaunay graph built with threshold `*`.                                          | Describes the distribution of local connectivity within the grain network at a given length scale. Deviations from typical distributions might indicate specific packing or ordering phenomena.      |
| `avg_clustering_*`               | Average clustering coefficient of the Delaunay graph built with threshold `*`. Measures the tendency of neighbors of a node to be neighbors themselves. | Quantifies the "cliquishness" or local density of connections in the grain network. High clustering suggests local ordering or grouping, affecting percolation or collective behavior.                |
| `is_small_world_*`               | Boolean flag indicating if the Delaunay graph (built with threshold `*`) exhibits small-world characteristics (high clustering, low average path length). | Suggests efficient connectivity despite local clustering. May be relevant for understanding signal propagation or transport efficiency through the microstructure network.                          |
| `shape_[feature]_mean/std`       | Mean and standard deviation of specific per-grain shape features calculated using helper functions (`perimeter_area_ratio`, `compactness`, `rectangularity`, `convex_defect`, `tortuosity`, `curvature_std`, `fourier_energy`). | Provides global statistics on specific aspects of grain shape regularity, complexity, and boundary characteristics across the entire microstructure.                                                |

*Note: Features marked with `*` (e.g., `delaunay_degree_*`, `avg_clustering_*`) are calculated for multiple distance thresholds (fixed and adaptive), resulting in multiple distinct features in the output (e.g., `global_avg_clustering_fixed_50`, `global_avg_clustering_adaptive_1r0_5std`).*
