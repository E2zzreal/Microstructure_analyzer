# `visualize_degree_outliers.py` Documentation

## Purpose

This script generates an image of the segmented microstructure, specifically highlighting grains whose degree (number of neighbors, based on a selected feature) falls outside a specified range. This helps to quickly identify grains with unusually high or low connectivity.

## Prerequisites

*   A `.mask` file containing the segmentation results for the sample.
*   A corresponding `_details.csv` file containing per-grain features, including the degree column to be analyzed. This file is generated by `run_feature_extraction.py` using the `--save_grain_details` flag.

## Usage

```bash
python visualize_degree_outliers.py --mask_path <path_to_mask_file> \
                                    --details_csv <path_to_details_file> \
                                    --output_path <path_to_save_image.png> \
                                    [--degree_column <degree_feature_name>] \
                                    [--min_degree <lower_bound>] \
                                    [--max_degree <upper_bound>]
```
**Note:** At least one of `--min_degree` or `--max_degree` must be provided.

## Arguments

*   `--mask_path` (required): Path to the input `.mask` file for the sample.
*   `--details_csv` (required): Path to the corresponding `_details.csv` file containing per-grain features.
*   `--output_path` (required): Path where the output visualization image (e.g., `.png`) will be saved.
*   `--degree_column` (optional): The name of the column in the `_details.csv` file containing the degree data. Default: `'neighbor_count'`.
*   `--min_degree` (optional): Integer value. Grains with a degree **less than** this value will be highlighted as outliers.
*   `--max_degree` (optional): Integer value. Grains with a degree **greater than** this value will be highlighted as outliers.

## Output

*   An image file (e.g., `.png`) saved at the specified `--output_path`. The image shows the segmented grains:
    *   Grains whose degree falls outside the specified range (`< min_degree` or `> max_degree`) are colored distinctly (default: red).
    *   Grains with degrees within the specified range (or if only one bound is given, those not meeting the outlier condition) are colored with a neutral color (default: gray).
    *   Background is typically white.
    *   A legend indicates the colors for outlier and normal degree grains.

## Interpretation & Materials Science Significance

*   **Identify Extremes**: Quickly locate grains with very low connectivity (potentially isolated or near edges/pores) or very high connectivity (potentially in densely packed clusters or representing artifacts if segmentation was imperfect).
*   **Spatial Location**: Observe where these outlier grains are located within the microstructure. Are low-degree grains predominantly near the sample boundaries? Are high-degree grains clustered in specific regions?
*   **Correlation with Other Features**: By comparing this visualization with plots generated by `visualize_spatial_coloring.py` (coloring by area, shape, etc.), you can investigate if outlier connectivity correlates with other grain characteristics.
*   **Link to Processing/Properties**: If certain types of outliers (e.g., a high prevalence of low-degree grains) are consistently observed in samples with specific properties or processing histories, it suggests a link between these extreme connectivity states and the overall material behavior or formation mechanism.

This visualization provides a focused view on the grains exhibiting unusual local connectivity, which might be critical points for understanding structural heterogeneity or failure initiation.
