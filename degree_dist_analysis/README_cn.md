# 晶粒度分布分析与可视化 (中文说明)

本文件夹包含一系列脚本，旨在对微观结构的拓扑特征进行深入分析和可视化，特别是关注晶粒度分布（即晶粒的邻居数量 `neighbor_count`）及其与其他晶粒属性的关系。这些分析有助于理解机器学习模型识别出的重要特征背后的材料学意义。

## 先决条件

这些脚本依赖于主特征提取流程 (`run_feature_extraction.py`) 生成的包含每个晶粒详细信息的文件 (`*_details.csv`)。请确保在运行特征提取时启用了 `--save_grain_details` 标志：

```bash
python ../run_feature_extraction.py --mask_dir <你的掩码目录> --output_csv <聚合特征输出文件.csv> --save_grain_details --details_output_dir <你的详细数据目录>
```

## 脚本说明

每个脚本的详细说明可以在其对应的 Markdown 文件中找到：

*   **[`visualize_network.py`](visualize_network.md)** (英文文档): 可视化叠加在微观结构图像上的晶粒连接网络。网络中的节点（晶粒）可以根据选定的特征（如度、面积）进行着色和调整大小。
*   **[`plot_degree_vs_property.py`](plot_degree_vs_property.md)** (英文文档): 创建散点图（或其他类型，如 hexbin、kde）来探索晶粒度 (`neighbor_count`) 与其他几何或形状属性（如面积、长宽比）之间的关系。
*   **[`visualize_spatial_coloring.py`](visualize_spatial_coloring.md)** (英文文档): 生成一张图像，其中每个晶粒根据特定特征（如度、面积、方向）的值进行着色，以揭示空间模式或聚类。

## 分析流程与结果解读

1.  **运行特征提取（包含详细信息）**: 为您想要分析的样本生成 `*_details.csv` 文件。
2.  **识别重要特征**: 利用 `run_model_analysis.py` 的结果（特征重要性、SHAP 图）来确定哪些 `grain_degree_dist_*` 或其他拓扑/几何特征对预测目标属性影响最大。
3.  **可视化网络 (`visualize_network.py`)**:
    *   选择具有代表性的样本（例如，目标属性值高/低的样本）。
    *   运行脚本，使用重要特征（如 `neighbor_count`, `area`）对着色/调整节点大小。
    *   **解读**: 观察网络拓扑结构的差异。性能好的样本是否显示出更均匀的网络？高度数节点是否聚集在一起？节点大小是否与度数在视觉上相关？
4.  **分析度数与属性的关系 (`plot_degree_vs_property.py`)**:
    *   为代表性样本运行脚本，绘制 `neighbor_count` 与其他可能相关的特征（如 `area`, `aspect_ratio`）的关系图。
    *   **解读**: 寻找趋势。小晶粒是否倾向于具有更高的度数？形状和连通性之间是否存在关系？这种关系在性能高/低的样本之间有何不同？
5.  **可视化空间模式 (`visualize_spatial_coloring.py`)**:
    *   运行脚本，使用 `neighbor_count` 或其他重要特征对晶粒进行着色。
    *   **解读**: 寻找高/低度数晶粒的空间聚类。具有特定连通性模式的晶粒是否位于某些边界或缺陷附近（如果在原始图像中可见）？
6.  **综合分析**: 将可视化得到的直观见解与 SHAP 分析（尤其是依赖图）的定量结果相结合，以更深入地理解特定的拓扑排列（通过度分布及相关特征捕捉）如何影响材料的性能。这种理解可以指导工程师设计具有所需特性的微观结构，以实现性能改进（材料逆向设计）。
