# Degree Distribution Analysis and Visualization

This folder contains scripts designed to perform in-depth analysis and visualization focusing on the topological features of the microstructure, particularly the grain degree distribution (`neighbor_count`) and its relationship with other grain properties. These analyses help in understanding the materials science implications behind the features identified as important by machine learning models.

## Prerequisites

These scripts generally rely on the per-grain detail files (`*_details.csv`) generated by the main feature extraction pipeline (`run_feature_extraction.py`). Ensure you run the feature extraction with the `--save_grain_details` flag enabled:

```bash
python ../run_feature_extraction.py --mask_dir <your_mask_dir> --output_csv <aggregate_output.csv> --save_grain_details --details_output_dir <your_details_dir>
```

## Scripts

### `batch_all_degree_analysis.py`

(Documentation from `batch_all_degree_analysis_cn.md` needs to be translated or an English version provided separately. Assuming English documentation would be similar to the Chinese one provided earlier.)

*Note: English documentation for this script was not provided. Please refer to the Chinese documentation (`README_cn.md`) or the script's code for details.*

### `batch_compare_features.py`

#### Purpose

This script facilitates batch processing by calling `compare_degree_distributions.py` repeatedly for a list of specified features. It generates all four comparison plot types (KDE, Box, Violin, Histogram) for each feature, saving them to a designated output folder. This is useful for quickly comparing the distributions of multiple grain characteristics across all samples based on their Hc20 performance.

#### Prerequisites

*   `compare_degree_distributions.py` script in the same directory.
*   Multiple `_details.csv` files located within the specified details folder, containing the features listed for plotting.
*   `data/database-250211.csv` file containing 'Hc20' values indexed by sample ID.

#### Usage

```bash
python batch_compare_features.py --details_folder <path_to_details_folder> \
                                 --output_base_folder <path_to_output_directory> \
                                 [--features <feature1> <feature2> ...]
```

#### Arguments

*   `--details_folder` (required): Path to the directory containing the `_details.csv` files (e.g., `results/per_grain_details`).
*   `--output_base_folder` (required): Base path where the output comparison plots will be saved (e.g., `results/batch_compare_features`). The script will create this directory if it doesn't exist.
*   `--features` (optional): A list of feature column names from the `_details.csv` files to plot. If not provided, a default list including common geometric and topological features is used: `['area', 'perimeter', 'major_axis_length', 'minor_axis_length', 'aspect_ratio', 'circularity', 'delaunay_degree_adaptive_2r0_5std', 'neighbor_count']`.

#### Output

*   Multiple image files (e.g., `.png`) saved in the specified `--output_base_folder`.
*   Each file is named according to the pattern: `{feature_name}_{plot_type}.png` (e.g., `area_kde.png`, `delaunay_degree_adaptive_2r0_5std_box.png`).
*   Each plot compares the distribution of the specified feature across all samples, sorted by Hc20 value.

### `compare_degree_distributions.py`

#### Purpose

This script compares the grain degree distributions across multiple samples or predefined groups of samples. It reads per-grain detail files (`_details.csv`) for several samples, extracts a specified degree feature (e.g., `neighbor_count`, `delaunay_degree_adaptive_1r1std`), and generates plots (like KDE, box plots, violin plots, or faceted histograms) to visually compare the distributions.

This is useful for identifying systematic differences in grain connectivity patterns between different experimental conditions, material batches, or performance groups.

#### Prerequisites

*   Multiple `_details.csv` files, one for each sample to be compared, located within a specified folder. These files must contain the degree column chosen for comparison. They are generated by `run_feature_extraction.py` using the `--save_grain_details` flag.

#### Usage

```bash
python compare_degree_distributions.py --details_folder <path_to_folder_with_details_files> \
                                       --output_path <path_to_save_comparison_plot.png> \
                                       [--file_pattern <glob_pattern>] \
                                       [--degree_column <degree_feature_name>] \
                                       [--plot_type <type>] \
                                       [--labels <label1> <label2> ...]
```

#### Arguments

*   `--details_folder` (required): Path to the directory containing the `_details.csv` files for the samples to compare.
*   `--output_path` (required): Path where the output comparison plot image (e.g., `.png`) will be saved.
*   `--file_pattern` (optional): A glob pattern used to find the relevant `_details.csv` files within the `--details_folder`. Default: `'*_details.csv'`.
*   `--degree_column` (optional): The name of the column in the `_details.csv` files containing the degree data to compare. Default: `'neighbor_count'`.
*   `--plot_type` (optional): The type of plot to generate for comparison. Options are:
    *   `'kde'` (default): Kernel Density Estimate plots, overlaid for comparison. Good for visualizing distribution shapes and peaks.
    *   `'box'`: Box plots for each sample/group, showing median, quartiles, and potential outliers. Good for comparing central tendency and spread.
    *   `'violin'`: Violin plots, combining aspects of box plots and KDE plots. Good for visualizing distribution shape and density simultaneously.
    *   `'hist'`: Faceted histograms, showing the distribution for each sample in separate panels. Good for detailed frequency comparison.
*   `--labels` (optional): A list of custom labels to assign to each sample/file found (in the order they are processed, usually alphabetical). If not provided, labels are automatically generated from the beginning of the filenames (before the first underscore).

#### Output

*   An image file (e.g., `.png`) saved at the specified `--output_path`. The plot visually compares the distribution of the selected degree feature across the different samples included in the analysis.

#### Interpretation & Materials Science Significance

*   **Distribution Comparison (KDE/Hist)**: Compare the shapes, peak locations, and widths of the distributions between samples/groups. Does one group consistently show a higher average degree? Is the distribution wider or narrower in one group? Are there multiple peaks indicating distinct populations of grain connectivity?
*   **Central Tendency & Spread (Box/Violin)**: Compare the median degree (center line in box plot), interquartile range (box height), and overall range (whiskers) between groups. Are there significant differences in the typical connectivity or the variability of connectivity?
*   **Statistical Significance**: While this script provides visual comparison, observed differences might need formal statistical testing (e.g., t-test, ANOVA, Kruskal-Wallis test on the degree data grouped by sample) to confirm significance if required.
*   **Link to Properties/Conditions**: Relate the observed differences in degree distributions to the known differences in material properties (e.g., Hc20) or processing conditions associated with the samples/groups. This helps establish structure-property or processing-structure relationships involving grain topology.

This script facilitates the comparative analysis of grain connectivity patterns, a crucial step in understanding how microstructural topology varies and potentially influences material behavior.

#### Plot Type Details

##### Kernel Density Estimate (KDE)
- **Principle**: Shows distribution shape and peaks through data smoothing
- **Key Interpretation Points**:
  - Peak position (mode) indicates most frequent degree value
  - Number of peaks reveals presence of distinct grain connectivity populations
  - Distribution width reflects dispersion
  - Curve overlap between groups shows similarity
- **Best Use Cases**: Comparing overall distribution shapes and peak positions

##### Box Plot
- **Principle**: Displays median, quartiles and potential outliers
- **Key Interpretation Points**:
  - Box shows 25th-75th percentiles (IQR)
  - Center line is the median
  - Whiskers extend to 1.5Ã—IQR range
  - Points beyond whiskers are outliers
- **Best Use Cases**: Quick comparison of central tendency and spread

##### Violin Plot
- **Principle**: Combines features of box plots and KDE
- **Key Interpretation Points**:
  - Width represents data density
  - Typically includes box plot elements inside
  - Particularly good for showing multimodal distributions
- **Best Use Cases**: Simultaneous comparison of distribution shape, density and central tendency

##### Faceted Histogram
- **Principle**: Divides data into bins and shows frequencies
- **Key Interpretation Points**:
  - Frequency counts per bin
  - Overall distribution shape (discrete form)
  - Identifies data gaps or value clusters
- **Best Use Cases**: Detailed comparison of frequency distributions in specific degree ranges

### `plot_degree_histogram.py`

#### Purpose

This script plots the distribution of a selected grain degree feature (e.g., `neighbor_count`, `delaunay_degree_fixed_50`, `delaunay_degree_adaptive_1r1std`) for a single sample. It helps visualize the frequency of grains with different numbers of neighbors according to a specific definition of neighborhood.

#### Prerequisites

*   A `_details.csv` file containing per-grain features for the sample, including the degree column specified for plotting. This file is generated by `run_feature_extraction.py` using the `--save_grain_details` flag.

#### Usage

```bash
python plot_degree_histogram.py --details_csv <path_to_details_file> \
                                --output_path <path_to_save_image.png> \
                                [--degree_column <degree_feature_name>] \
                                [--bin_width <width>] \
                                [--plot_type <type>]
```

#### Arguments

*   `--details_csv` (required): Path to the input `_details.csv` file containing per-grain features.
*   `--output_path` (required): Path where the output plot image (e.g., `.png`) will be saved.
*   `--degree_column` (optional): The name of the column in the `_details.csv` file containing the degree data to plot. Default: `'neighbor_count'`. You can specify other calculated degrees like `'delaunay_degree_fixed_50'` or `'delaunay_degree_adaptive_1r1std'`.
*   `--bin_width` (optional): The width of bins to use when `plot_type` is `'hist'`. Default: `1`.
*   `--plot_type` (optional): The type of plot to generate. Options are:
    *   `'hist'` (default): Generates a histogram showing the count of grains within degree bins.
    *   `'bar'`: Generates a bar chart showing the exact count for each discrete degree value.

#### Output

*   An image file (e.g., `.png`) saved at the specified `--output_path`. The plot shows the distribution of the selected grain degree feature for the sample.

#### Interpretation & Materials Science Significance

*   **Distribution Shape**: Observe the overall shape of the distribution. Is it unimodal (single peak), bimodal, or multimodal? Is it symmetric, skewed left, or skewed right? This reflects the typical connectivity environment of grains.
*   **Peak Location**: Identify the most frequent degree value(s). This indicates the most common local arrangement of grains.
*   **Spread/Width**: Assess the range or standard deviation of the degrees. A narrow distribution suggests a more uniform connectivity pattern, while a wide distribution indicates greater heterogeneity in local environments.
*   **Comparison (Manual)**: Generate histograms for different degree definitions (e.g., physical vs. Delaunay adaptive) for the same sample to see how the neighborhood definition affects the perceived connectivity distribution. Generate histograms for the same degree definition across different samples to visually compare their distributions (though `compare_degree_distributions.py` is better suited for formal comparison).

This plot provides a fundamental characterization of the sample's topological structure based on local grain connectivity.

### `plot_degree_vs_property.py`

#### Purpose

This script generates plots to explore the relationship between the topological degree of a grain (i.e., its number of neighbors, typically `neighbor_count`) and other geometric or shape properties of that grain (e.g., `area`, `aspect_ratio`, `compactness`).

Understanding these relationships can reveal if certain types of grains (e.g., small grains, elongated grains) tend to have higher or lower connectivity within the microstructure.

#### Prerequisites

*   A `_details.csv` file containing per-grain features for the sample, including `neighbor_count` (or the specified degree feature) and the chosen property feature. This file is generated by `run_feature_extraction.py` using the `--save_grain_details` flag.

#### Usage

```bash
python plot_degree_vs_property.py --details_csv <path_to_details_file> \
                                  --output_path <path_to_save_image.png> \
                                  [--property <feature_name>] \
                                  [--degree <feature_name>] \
                                  [--plot_type <type>]
```

#### Arguments

*   `--details_csv` (required): Path to the input `_details.csv` file containing per-grain features.
*   `--output_path` (required): Path where the output plot image (e.g., `.png`) will be saved.
*   `--property` (optional): The name of the feature column to plot on the x-axis. Default: `'area'`.
*   `--degree` (optional): The name of the feature column (representing grain degree) to plot on the y-axis. Default: `'delaunay_degree_adaptive_2r0_5std'`.
*   `--plot_type` (optional): The type of plot to generate. Options are:
    *   `'scatter'` (default): Shows individual data points. Good for observing raw distribution but can suffer from overplotting with many points.
    *   `'hexbin'`: Aggregates points into hexagonal bins, coloring bins by point density. Good for large datasets to visualize density patterns.
    *   `'kde'`: Kernel Density Estimate plot. Shows the estimated probability density of the data points. Good for visualizing the overall shape and peaks of the distribution.

#### Output

*   An image file (e.g., `.png`) saved at the specified `--output_path`. The plot shows the relationship between the selected grain property (x-axis) and the grain degree (y-axis).

#### Interpretation & Materials Science Significance

*   **Trend Analysis**: Look for overall trends in the plot. Does the degree tend to increase or decrease as the property value changes? For example, plotting degree vs. area might show if smaller grains generally have more or fewer neighbors than larger grains.
*   **Distribution Shape (KDE/Hexbin)**: Observe where the data points are concentrated. Are there specific combinations of property value and degree that are particularly common?
*   **Outliers**: Identify any grains that have unusual combinations of property and degree.
*   **Comparison**: Generate these plots for samples with different overall properties (e.g., high vs. low Hc20) or processed under different conditions. Compare the trends. Does the relationship between grain size/shape and connectivity change significantly between samples?
*   **Link to Theory**: Relate observed trends to theoretical expectations or known phenomena. For instance, in densely packed structures, smaller grains might be expected to have a higher average number of neighbors (approaching values related to packing density). Deviations from this might indicate specific structural features or non-ideal packing.

By examining these plots, you can gain a quantitative understanding of how local connectivity (degree) relates to other fundamental grain characteristics within the microstructure.

### `visualize_degree_outliers.py`

#### Purpose

This script generates an image of the segmented microstructure, specifically highlighting grains whose degree (number of neighbors, based on a selected feature) falls outside a specified range. This helps to quickly identify grains with unusually high or low connectivity.

#### Prerequisites

*   A `.mask` file containing the segmentation results for the sample.
*   A corresponding `_details.csv` file containing per-grain features, including the degree column to be analyzed. This file is generated by `run_feature_extraction.py` using the `--save_grain_details` flag.

#### Usage

```bash
python visualize_degree_outliers.py --mask_path <path_to_mask_file> \
                                    --details_csv <path_to_details_file> \
                                    --output_path <path_to_save_image.png> \
                                    [--degree_column <degree_feature_name>] \
                                    [--min_degree <lower_bound>] \
                                    [--max_degree <upper_bound>]
```
**Note:** At least one of `--min_degree` or `--max_degree` must be provided.

#### Arguments

*   `--mask_path` (required): Path to the input `.mask` file for the sample.
*   `--details_csv` (required): Path to the corresponding `_details.csv` file containing per-grain features.
*   `--output_path` (required): Path where the output visualization image (e.g., `.png`) will be saved.
*   `--degree_column` (optional): The name of the column in the `_details.csv` file containing the degree data. Default: `'neighbor_count'`.
*   `--min_degree` (optional): Integer value. Grains with a degree **less than** this value will be highlighted as outliers.
*   `--max_degree` (optional): Integer value. Grains with a degree **greater than** this value will be highlighted as outliers.

#### Output

*   An image file (e.g., `.png`) saved at the specified `--output_path`. The image shows the segmented grains:
    *   Grains whose degree falls outside the specified range (`< min_degree` or `> max_degree`) are colored distinctly (default: red).
    *   Grains with degrees within the specified range (or if only one bound is given, those not meeting the outlier condition) are colored with a neutral color (default: gray).
    *   Background is typically white.
    *   A legend indicates the colors for outlier and normal degree grains.

#### Interpretation & Materials Science Significance

*   **Identify Extremes**: Quickly locate grains with very low connectivity (potentially isolated or near edges/pores) or very high connectivity (potentially in densely packed clusters or representing artifacts if segmentation was imperfect).
*   **Spatial Location**: Observe where these outlier grains are located within the microstructure. Are low-degree grains predominantly near the sample boundaries? Are high-degree grains clustered in specific regions?
*   **Correlation with Other Features**: By comparing this visualization with plots generated by `visualize_spatial_coloring.py` (coloring by area, shape, etc.), you can investigate if outlier connectivity correlates with other grain characteristics.
*   **Link to Processing/Properties**: If certain types of outliers (e.g., a high prevalence of low-degree grains) are consistently observed in samples with specific properties or processing histories, it suggests a link between these extreme connectivity states and the overall material behavior or formation mechanism.

This visualization provides a focused view on the grains exhibiting unusual local connectivity, which might be critical points for understanding structural heterogeneity or failure initiation.

### `visualize_network.py`

#### Purpose

This script visualizes the grain connectivity network for a single sample. It reads the segmentation mask data and the corresponding per-grain feature details, builds a network graph (typically Delaunay triangulation based on centroids, filtered by distance), and overlays this network onto either the original SEM image (if provided) or the segmented grain boundaries. Nodes in the network represent individual grains and can be colored and sized based on specific features extracted for each grain (like neighbor count, area, etc.).

This visualization helps in understanding the spatial arrangement and connectivity patterns of grains within the microstructure.

#### Prerequisites

*   A `.mask` file containing the segmentation results for the sample.
*   A corresponding `_details.csv` file containing per-grain features (including centroids, and the features chosen for coloring/sizing). This file is generated by `run_feature_extraction.py` using the `--save_grain_details` flag.

#### Usage

```bash
python visualize_network.py --mask_path <path_to_mask_file> \
                            --details_csv <path_to_details_file> \
                            --output_path <path_to_save_image.png> \
                            [--image_path <path_to_original_tif>] \
                            [--distance_threshold <value>] \
                            [--color_feature <feature_name>] \
                            [--size_feature <feature_name>] \
                            [--min_size <value>] \
                            [--max_size <value>] \
                            [--cmap <colormap_name>]
```

#### Arguments

*   `--mask_path` (required): Path to the input `.mask` file for the sample.
*   `--details_csv` (required): Path to the corresponding `_details.csv` file containing per-grain features.
*   `--output_path` (required): Path where the output visualization image (e.g., `.png`) will be saved.
*   `--image_path` (optional): Path to the original image file (e.g., `.tif`). If provided, the network will be overlaid on this image. Otherwise, it will be overlaid on the segmented grain boundaries.
*   `--distance_threshold` (optional): Maximum distance (in pixels) between centroids for two grains to be considered connected in the Delaunay graph. Default: `50`. Adjusting this can reveal connectivity at different spatial scales.
*   `--color_feature` (optional): The name of the column in the `_details.csv` file to use for coloring the nodes (grains). Default: `'delaunay_degree_adaptive_2r0_5std'`.
*   `--size_feature` (optional): The name of the column in the `_details.csv` file to use for sizing the nodes (grains). Default: `'area'`. Node sizes are scaled linearly between `--min_size` and `--max_size`.
*   `--min_size` (optional): Minimum node size in the plot. Default: `10`.
*   `--max_size` (optional): Maximum node size in the plot. Default: `500`.
*   `--cmap` (optional): The name of the Matplotlib colormap to use for node coloring. Default: `'viridis'`.

#### Output

*   An image file (e.g., `.png`) saved at the specified `--output_path`. This image shows the grain network:
    *   **Background**: Either the original SEM image or the segmented grain boundaries.
    *   **Nodes**: Represent grain centroids. Their color and size are determined by the `--color_feature` and `--size_feature` arguments, respectively.
    *   **Edges**: Represent connections between neighboring grains (based on the Delaunay graph and distance threshold).

#### Interpretation & Materials Science Significance

*   **Connectivity**: Observe the overall density and pattern of edges. Are grains highly interconnected, or are there isolated regions?
*   **Node Coloring (e.g., by `neighbor_count`)**: Identify regions with high or low local connectivity. Are high-degree grains clustered together? How does connectivity relate to grain position (e.g., near sample edges)?
*   **Node Sizing (e.g., by `area`)**: Visually assess the relationship between grain size and connectivity. Do large grains tend to have fewer neighbors?
*   **Comparison**: Generate these plots for samples with different properties (e.g., high vs. low Hc20). Compare their network structures. Does the better-performing sample exhibit a more uniform network, specific clustering patterns, or different relationships between size, shape, and connectivity?
*   **Correlation with Defects**: If overlaid on the original image, correlate network features (like low-degree nodes or broken connections) with visible defects or phase boundaries.

By analyzing these network visualizations, you can gain insights into how the topological arrangement of grains, beyond simple average size or shape, might influence material properties.

### `visualize_spatial_coloring.py`

#### Purpose

This script generates an image of the segmented microstructure where each individual grain is colored based on the value of a specific feature associated with that grain (e.g., its neighbor count, area, orientation, aspect ratio).

This type of visualization is useful for identifying spatial patterns, clusters, or gradients related to the chosen feature within the microstructure.

#### Prerequisites

*   A `.mask` file containing the segmentation results for the sample.
*   A corresponding `_details.csv` file containing per-grain features, including the feature selected for coloring. This file is generated by `run_feature_extraction.py` using the `--save_grain_details` flag.

#### Usage

```bash
python visualize_spatial_coloring.py --mask_path <path_to_mask_file> \
                                     --details_csv <path_to_details_file> \
                                     --output_path <path_to_save_image.png> \
                                     [--color_feature <feature_name>] \
                                     [--cmap <colormap_name>]
```

#### Arguments

*   `--mask_path` (required): Path to the input `.mask` file for the sample.
*   `--details_csv` (required): Path to the corresponding `_details.csv` file containing per-grain features.
*   `--output_path` (required): Path where the output visualization image (e.g., `.png`) will be saved.
*   `--color_feature` (optional): The name of the column in the `_details.csv` file to use for coloring the grains. Default: `'neighbor_count'`.
*   `--cmap` (optional): The name of the Matplotlib colormap to use for coloring. Default: `'viridis'`.

#### Output

*   An image file (e.g., `.png`) saved at the specified `--output_path`. The image shows the segmented grains, with each grain colored according to its value for the specified `--color_feature`. A colorbar is included to indicate the mapping between color and feature value. Background (non-grain regions) is typically shown in white or another neutral color.

#### Interpretation & Materials Science Significance

*   **Spatial Clustering**: Look for regions where grains with similar feature values (e.g., high `neighbor_count`, large `area`, specific `orientation`) are clustered together. Does the microstructure exhibit heterogeneity in terms of this feature?
*   **Gradients**: Observe if there are gradients in the feature values across the sample (e.g., smaller grains near one edge, larger grains near another).
*   **Correlation with Location**: Are grains with particular feature values preferentially located near certain microstructural elements (e.g., sample edges, large pores, specific phases if identifiable)?
*   **Anisotropy**: If coloring by `orientation`, does the visualization reveal preferred orientations or textures within the material?
*   **Comparison**: Generate these plots for different features on the same sample to see how spatial patterns correlate. Compare plots for the same feature across different samples (e.g., high vs. low Hc20) to identify systematic differences in spatial organization.

This visualization provides a direct spatial mapping of quantitative grain features, helping to bridge the gap between statistical feature values and the actual physical arrangement within the material.

## Analysis Workflow & Interpretation

1.  **Run Feature Extraction with Details**: Generate the `*_details.csv` files for the samples you want to analyze.
2.  **Identify Important Features**: Use the results from `run_model_analysis.py` (feature importance, SHAP plots) to identify which `grain_degree_dist_*` or other topological/geometric features are most influential for predicting the target property.
3.  **Visualize Network (`visualize_network.py`)**:
    *   Select representative samples (e.g., high vs. low target property values).
    *   Run the script, coloring/sizing nodes by the important features (e.g., `neighbor_count`, `area`).
    *   **Interpretation**: Observe differences in network topology. Does the high-performing sample show a more uniform network? Are high-degree nodes clustered? Does node size correlate visually with degree?
4.  **Analyze Degree vs. Property (`plot_degree_vs_property.py`)**:
    *   Run the script for representative samples, plotting `neighbor_count` against other potentially relevant features (e.g., `area`, `aspect_ratio`).
    *   **Interpretation**: Look for trends. Do smaller grains tend to have higher degrees (based on a specific threshold)? Is there a relationship between shape and connectivity? How does this relationship differ between high/low performing samples?
5.  **Visualize Spatial Patterns (`visualize_spatial_coloring.py`)**:
    *   Run the script coloring grains by an important degree feature (e.g., `delaunay_degree_adaptive_1r1std`) or other relevant features.
    *   **Interpretation**: Look for spatial clustering of high/low degree grains. Are grains with specific connectivity patterns located near certain boundaries or defects (if visible in the original image)?
6.  **Analyze Degree Distribution (`plot_degree_histogram.py`)**:
    *   Generate histograms for important degree features (e.g., physical `neighbor_count`, adaptive Delaunay degrees) for representative samples.
    *   **Interpretation**: Characterize the shape of the distribution (e.g., unimodal, bimodal, skewed). What is the most common degree? How wide is the distribution?
7.  **Compare Distributions (`compare_degree_distributions.py`)**:
    *   Compare the degree distributions (using KDE or box plots) between high-performing and low-performing sample groups for the most relevant degree features.
    *   **Interpretation**: Are there statistically significant differences in the distribution shapes, means, or variances between the groups? This provides strong evidence for the role of connectivity patterns.
8.  **Identify Outliers (`visualize_degree_outliers.py`)**:
    *   Highlight grains with unusually low or high connectivity based on a chosen degree feature.
    *   **Interpretation**: Examine the location and characteristics of these outlier grains. Are they associated with specific phases, defects, or boundary types? Do they form clusters?
9.  **Synthesize Findings**: Combine the visual insights from all plots with the quantitative results from SHAP analysis (especially dependence plots) to build a stronger understanding of how specific topological arrangements (captured by degree distribution and related features) influence the material's properties. This understanding can guide efforts to engineer microstructures with desired characteristics for improved performance (materials inverse design).
